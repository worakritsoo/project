var t=Object.defineProperty,e=Object.prototype.hasOwnProperty,o=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,a=(e,o,n)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,s=(t,s)=>{for(var r in s||(s={}))e.call(s,r)&&a(t,r,s[r]);if(o)for(var r of o(s))n.call(s,r)&&a(t,r,s[r]);return t};import{Q as r,S as l,i as c,s as d,e as i,k as u,c as f,a as h,n as p,d as m,b as v,E as y,f as w,G as g,R as b,T as j,U as x,V as E,W as O,O as T,t as M,P,g as k,X as _,u as U,v as I,r as N,Y as R,B,Z as D,H as F}from"../../chunks/vendor-0bc65d02.js";import{c as $,s as S}from"../../chunks/index-0ee0897d.js";function H(t,{pending:e,error:o,result:n}){let a;async function s(s){const r=a={};s.preventDefault();const l=new FormData(t);e&&e(l,t);try{const e=await fetch(t.action,{method:t.method,headers:{accept:"application/json"},body:l});if(r!==a)return;e.ok?n(e,t):o?o(e,null,t):console.error(await e.text())}catch(c){if(!o)throw c;o(null,c,t)}}return t.addEventListener("submit",s),{destroy(){t.removeEventListener("submit",s)}}}function V(t,e,o={}){const n=getComputedStyle(t),a="none"===n.transform?"":n.transform,s=e.from.width/t.clientWidth,l=e.from.height/t.clientHeight,c=(e.from.left-e.to.left)/s,d=(e.from.top-e.to.top)/l,i=Math.sqrt(c*c+d*d),{delay:u=0,duration:f=(t=>120*Math.sqrt(t)),easing:h=$}=o;return{delay:u,duration:r(f)?f(i):f,easing:h,css:(t,e)=>`transform: ${a} translate(${e*c}px, ${e*d}px);`}}function q(t,e,o){const n=t.slice();return n[6]=e[o],n}function C(t,e){let o,n,a,s,l,c,d,M,P,k,_,U,I,N,B,D,$,q,C,L,W,G,Q,X,Y,Z,z,A=F;function J(...t){return e[3](e[6],...t)}function K(){return e[4](e[6])}return{key:t,first:null,c(){o=i("div"),n=i("form"),a=i("input"),l=u(),c=i("button"),k=u(),_=i("form"),U=i("input"),N=u(),B=i("button"),$=u(),q=i("form"),C=i("button"),G=u(),this.h()},l(t){o=f(t,"DIV",{class:!0});var e=h(o);n=f(e,"FORM",{action:!0,method:!0});var s=h(n);a=f(s,"INPUT",{type:!0,name:!0,value:!0,class:!0}),l=p(s),c=f(s,"BUTTON",{class:!0,"aria-label":!0}),h(c).forEach(m),s.forEach(m),k=p(e),_=f(e,"FORM",{class:!0,action:!0,method:!0});var r=h(_);U=f(r,"INPUT",{type:!0,name:!0,value:!0,class:!0}),N=p(r),B=f(r,"BUTTON",{class:!0,"aria-label":!0}),h(B).forEach(m),r.forEach(m),$=p(e),q=f(e,"FORM",{action:!0,method:!0});var d=h(q);C=f(d,"BUTTON",{class:!0,"aria-label":!0}),h(C).forEach(m),d.forEach(m),G=p(e),e.forEach(m),this.h()},h(){v(a,"type","hidden"),v(a,"name","done"),a.value=s=e[6].done?"":"true",v(a,"class","svelte-13wdnuf"),v(c,"class","toggle svelte-13wdnuf"),v(c,"aria-label",d="Mark todo as "+(e[6].done?"not done":"done")),v(n,"action",M="/todos/"+e[6].uid+".json?_method=patch"),v(n,"method","post"),v(U,"type","text"),v(U,"name","text"),U.value=I=e[6].text,v(U,"class","svelte-13wdnuf"),v(B,"class","save svelte-13wdnuf"),v(B,"aria-label","Save todo"),v(_,"class","text svelte-13wdnuf"),v(_,"action",D="/todos/"+e[6].uid+".json?_method=patch"),v(_,"method","post"),v(C,"class","delete svelte-13wdnuf"),v(C,"aria-label","Delete todo"),v(q,"action",L="/todos/"+e[6].uid+".json?_method=delete"),v(q,"method","post"),v(o,"class","todo svelte-13wdnuf"),y(o,"done",e[6].done),this.first=o},m(t,s){w(t,o,s),g(o,n),g(n,a),g(n,l),g(n,c),g(o,k),g(o,_),g(_,U),g(_,N),g(_,B),g(o,$),g(o,q),g(q,C),g(o,G),Y=!0,Z||(z=[b(P=H.call(null,n,{pending:J,result:e[1]})),b(H.call(null,_,{result:e[1]})),b(W=H.call(null,q,{result:K}))],Z=!0)},p(t,l){e=t,(!Y||1&l&&s!==(s=e[6].done?"":"true"))&&(a.value=s),(!Y||1&l&&d!==(d="Mark todo as "+(e[6].done?"not done":"done")))&&v(c,"aria-label",d),(!Y||1&l&&M!==(M="/todos/"+e[6].uid+".json?_method=patch"))&&v(n,"action",M),P&&r(P.update)&&1&l&&P.update.call(null,{pending:J,result:e[1]}),(!Y||1&l&&I!==(I=e[6].text)&&U.value!==I)&&(U.value=I),(!Y||1&l&&D!==(D="/todos/"+e[6].uid+".json?_method=patch"))&&v(_,"action",D),(!Y||1&l&&L!==(L="/todos/"+e[6].uid+".json?_method=delete"))&&v(q,"action",L),W&&r(W.update)&&1&l&&W.update.call(null,{result:K}),1&l&&y(o,"done",e[6].done)},r(){X=o.getBoundingClientRect()},f(){j(o),A(),x(o,X)},a(){A(),A=E(o,X,V,{duration:200})},i(t){Y||(t&&R((()=>{Q||(Q=O(o,S,{start:.7},!0)),Q.run(1)})),Y=!0)},o(t){t&&(Q||(Q=O(o,S,{start:.7},!1)),Q.run(0)),Y=!1},d(t){t&&m(o),t&&Q&&Q.end(),Z=!1,T(z)}}}function L(t){let e,o,n,a,s,l,c,d,y,j,x,E,O=[],T=new Map,R=t[0];const F=t=>t[6].uid;for(let r=0;r<R.length;r+=1){let e=q(t,R,r),o=F(e);T.set(o,O[r]=C(o,e))}return{c(){e=u(),o=i("div"),n=i("h1"),a=M("Todos"),s=u(),l=i("form"),c=i("input"),y=u();for(let t=0;t<O.length;t+=1)O[t].c();this.h()},l(t){P('[data-svelte="svelte-181o7gf"]',document.head).forEach(m),e=p(t),o=f(t,"DIV",{class:!0});var r=h(o);n=f(r,"H1",{});var d=h(n);a=k(d,"Todos"),d.forEach(m),s=p(r),l=f(r,"FORM",{class:!0,action:!0,method:!0});var i=h(l);c=f(i,"INPUT",{name:!0,placeholder:!0,class:!0}),i.forEach(m),y=p(r);for(let e=0;e<O.length;e+=1)O[e].l(r);r.forEach(m),this.h()},h(){document.title="Todos",v(c,"name","text"),v(c,"placeholder","+ tap to add a todo"),v(c,"class","svelte-13wdnuf"),v(l,"class","new svelte-13wdnuf"),v(l,"action","/todos.json"),v(l,"method","post"),v(o,"class","todos svelte-13wdnuf")},m(r,i){w(r,e,i),w(r,o,i),g(o,n),g(n,a),g(o,s),g(o,l),g(l,c),g(o,y);for(let t=0;t<O.length;t+=1)O[t].m(o,null);j=!0,x||(E=b(d=H.call(null,l,{result:t[2]})),x=!0)},p(t,[e]){if(d&&r(d.update)&&1&e&&d.update.call(null,{result:t[2]}),3&e){R=t[0],B();for(let t=0;t<O.length;t+=1)O[t].r();O=_(O,e,F,1,t,R,T,o,D,C,null,q);for(let t=0;t<O.length;t+=1)O[t].a();U()}},i(t){if(!j){for(let t=0;t<R.length;t+=1)I(O[t]);j=!0}},o(t){for(let e=0;e<O.length;e+=1)N(O[e]);j=!1},d(t){t&&m(e),t&&m(o);for(let e=0;e<O.length;e+=1)O[e].d();x=!1,E()}}}var W=function(t,e,o,n){return new(o||(o=Promise))((function(a,s){function r(t){try{c(n.next(t))}catch(e){s(e)}}function l(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,l)}c((n=n.apply(t,e||[])).next())}))};const G=({fetch:t})=>W(void 0,void 0,void 0,(function*(){const e=yield t("/todos.json");if(e.ok){return{props:{todos:yield e.json()}}}const{message:o}=yield e.json();return{error:new Error(o)}}));function Q(t,e,o){var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,s){function r(t){try{c(n.next(t))}catch(e){s(e)}}function l(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,l)}c((n=n.apply(t,e||[])).next())}))};let{todos:a}=e;return t.$$set=t=>{"todos"in t&&o(0,a=t.todos)},[a,function(t){return n(this,void 0,void 0,(function*(){const e=yield t.json();o(0,a=a.map((t=>t.uid===e.uid?e:t)))}))},async(t,e)=>{const n=await t.json();o(0,a=[...a,n]),e.reset()},(t,e)=>{const n=!!e.get("done");o(0,a=a.map((e=>e===t?s(s({},e),{done:n}):e)))},t=>{o(0,a=a.filter((e=>e.uid!==t.uid)))}]}export default class extends l{constructor(t){super(),c(this,t,Q,L,d,{todos:0})}}export{G as load};
